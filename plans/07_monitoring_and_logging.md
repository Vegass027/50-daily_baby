# –≠—Ç–∞–ø 7: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üéØ –¶–µ–ª–∏

1.  –°–æ–∑–¥–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —Ñ–∞–π–ª.
2.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä –±–∞–∑–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (—É—Å–ø–µ—à–Ω–æ—Å—Ç—å, —Å—Ä–µ–¥–Ω—è—è –∫–æ–º–∏—Å—Å–∏—è).
3.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É Webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Discord/Slack –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö.
4.  –í–Ω–µ–¥—Ä–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ (retry) —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –Ω–µ—É–¥–∞–≤—à–∏—Ö—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
5.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å fallback –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π RPC-—Å–µ—Ä–≤–µ—Ä.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
DEX_BOT/
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ utils/
    ‚îÇ   ‚îú‚îÄ‚îÄ Logger.ts
    ‚îÇ   ‚îú‚îÄ‚îÄ ErrorHandler.ts (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
    ‚îÇ   ‚îî‚îÄ‚îÄ PerformanceOptimizer.ts
    ‚îú‚îÄ‚îÄ logs/
    ‚îÇ   ‚îî‚îÄ‚îÄ transactions.log
    ‚îî‚îÄ‚îÄ bot.ts (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
```

## üìù –ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1.  **`src/utils/Logger.ts`**:
    -   –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `TransactionLogger` —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ª–æ–≥–∞, –∫–∞–∫ –≤ –≥–∞–π–¥–µ.
    -   **`logTransaction(log)`**:
        -   –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –º–∞—Å—Å–∏–≤ –ª–æ–≥–æ–≤.
        -   –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥ –≤ —Ñ–∞–π–ª `logs/transactions.log` –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
        -   –í—ã–≤–æ–¥–∏—Ç –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∫–æ–Ω—Å–æ–ª—å.
    -   **`getSuccessRate()`**, **`getAverageFee()`**:
        -   –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤.

2.  **`src/utils/ErrorHandler.ts`**:
    -   **Webhook-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**:
        -   –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `sendWebhookAlert(alert)` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `axios`.
        -   –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ `embed` –¥–ª—è Discord.
    -   **Retry-–ª–æ–≥–∏–∫–∞**:
        -   –°–æ–∑–¥–∞—Ç—å –æ–±–µ—Ä—Ç–∫—É `withRetry(fn, retries = 3)`
        -   –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å `fn` –¥–æ `retries` —Ä–∞–∑ —Å —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–π—Å—è –∑–∞–¥–µ—Ä–∂–∫–æ–π (`1s`, `3s`, `5s`) –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.
        -   –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—É–¥–∞—á–Ω—ã, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–∑–≤–∞—Ç—å `sendWebhookAlert` –∏ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—å –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ.
    -   **RPC Fallback**:
        -   –°–æ–∑–¥–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä `ConnectionManager`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π (`QUICKNODE_RPC_URL`) –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π (`HELIUS_RPC_URL`) `Connection`.
        -   –ü—Ä–∏ –æ—à–∏–±–∫–µ —Ç–∞–π–º–∞—É—Ç–∞, `ErrorHandler` –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π RPC.

3.  **`src/utils/PerformanceOptimizer.ts`**:
    -   –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å `PerformanceOptimizer` –∏–∑ –≥–∞–π–¥–∞.
    -   **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:
        -   `getCachedBalance` (–∫—ç—à –Ω–∞ 5 —Å–µ–∫—É–Ω–¥).
        -   `getCachedTokenMetadata` (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∫—ç—à).
        -   `getCachedBlockhash` (–∫—ç—à –Ω–∞ 50 —Å–µ–∫—É–Ω–¥).
    -   –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã —ç—Ç–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ `WalletManager` –∏ `SwapManager`, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ RPC-–∑–∞–ø—Ä–æ—Å–æ–≤.

4.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
    -   –í `SwapManager` –∏ `LimitOrderManager` –æ–±–µ—Ä–Ω—É—Ç—å –≤—ã–∑–æ–≤—ã `sendRawTransaction` –∏–ª–∏ `sendBundle` –≤ `withRetry`.
    -   –í –±–ª–æ–∫–∞—Ö `catch` –≤—ã–∑—ã–≤–∞—Ç—å `logger.logTransaction` —Å `status: 'failed'` –∏ `error: ...`.
    -   –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤—ã–∑—ã–≤–∞—Ç—å `logger.logTransaction` —Å `status: 'confirmed'`.

5.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)**:
    -   –î–æ–±–∞–≤–∏—Ç—å `WEBHOOK_URL` –¥–ª—è Discord/Slack.
    -   –î–æ–±–∞–≤–∏—Ç—å `HELIUS_RPC_URL` –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ.