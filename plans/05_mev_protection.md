# –≠—Ç–∞–ø 5: MEV –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ Jito

## üéØ –¶–µ–ª–∏

1.  –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Jito-–±–∞–Ω–¥–ª—ã –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç MEV (sandwich-–∞—Ç–∞–∫–∏, front-running).
2.  –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `JitoBundle` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —á–µ—Ä–µ–∑ Jito Block Engine.
3.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç "—á–∞–µ–≤—ã—Ö" (tip) –¥–ª—è Jito –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–¥–µ–ª–∫–∏.
4.  –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã `/toggle_mev` –∏ `/set_slippage`.
5.  –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –±–∞–Ω–¥–ª–æ–≤ –≤ `SwapManager` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –µ—Å–ª–∏ MEV-–∑–∞—â–∏—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
DEX_BOT/
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ utils/
    ‚îÇ   ‚îî‚îÄ‚îÄ JitoBundle.ts
    ‚îú‚îÄ‚îÄ trading/
    ‚îÇ   ‚îî‚îÄ‚îÄ SwapManager.ts (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
    ‚îî‚îÄ‚îÄ bot.ts (–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è)
```

## üìù –ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1.  **`src/utils/JitoBundle.ts`**:
    -   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `@jito-foundation/jito-ts`.
    -   –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `JitoBundle` —Å –º–µ—Ç–æ–¥–æ–º `sendBundle(transactions)`.
    -   –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–∞—Å—Å–∏–≤ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
    -   –í–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞:
        -   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Jito-–∫–ª–∏–µ–Ω—Ç (`searcherClient`) —Å URL –∏–∑ `.env`.
        -   –°–æ–∑–¥–∞—Ç—å –±–∞–Ω–¥–ª (`new Bundle(transactions, 5)`).
        -   –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–∞–Ω–¥–ª —á–µ—Ä–µ–∑ `searcherClient.sendBundle(bundle)`.
        -   –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±–∞–Ω–¥–ª–∞.

2.  **`src/trading/SwapManager.ts`**:
    -   –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `JitoBundle`.
    -   –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `executeSwap`:
        -   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ MEV-–∑–∞—â–∏—Ç–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        -   **–ï—Å–ª–∏ MEV –≤–∫–ª—é—á–µ–Ω–∞**:
            -   –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –æ—Ç Jupiter.
            -   –†–∞—Å—Å—á–∏—Ç–∞—Ç—å Jito tip (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10000 –ª–∞–º–ø–æ—Ä—Ç–æ–≤). –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è tip.
            -   –°–æ–∑–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ –¥–≤—É—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: [swap_transaction, tip_transaction].
            -   –í—ã–∑–≤–∞—Ç—å `jitoBundle.sendBundle()` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.
        -   **–ï—Å–ª–∏ MEV –≤—ã–∫–ª—é—á–µ–Ω–∞**:
            -   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É —Å `connection.sendRawTransaction`.

3.  **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç Jito Tip**:
    -   –í `JitoBundle.ts` –∏–ª–∏ `PriorityFeeCalculator.ts` —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `calculateJitoTip(tradeSizeSOL)`.
    -   –õ–æ–≥–∏–∫–∞: —á–µ–º –±–æ–ª—å—à–µ –æ–±—ä–µ–º —Å–¥–µ–ª–∫–∏, —Ç–µ–º –≤—ã—à–µ "—á–∞–µ–≤—ã–µ", —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –±–ª–æ–∫.
    -   –ù–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª: `tradeSize > 10 SOL -> tip = 20000`, `tradeSize > 1 SOL -> tip = 10000`, `default -> 5000`. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π tip - 1000 –ª–∞–º–ø–æ—Ä—Ç–æ–≤.

4.  **`src/bot.ts`**:
    -   –î–æ–±–∞–≤–∏—Ç—å `mevEnabled` –∏ `slippage` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    -   **`/toggle_mev`**:
        -   –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ñ–ª–∞–≥ `mevEnabled` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    -   **`/set_slippage [value]`**:
        -   –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ (slippage) –¥–ª—è Jupiter API. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (0.1 - 10%).
    -   –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É `/settings`, —á—Ç–æ–±—ã –æ–Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∞ —Å—Ç–∞—Ç—É—Å MEV-–∑–∞—â–∏—Ç—ã –∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ slippage.

5.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)**:
    -   –î–æ–±–∞–≤–∏—Ç—å `JITO_RPC_URL`.
    -   –î–æ–±–∞–≤–∏—Ç—å `DEFAULT_MEV_PROTECTION` –∏ `DEFAULT_SLIPPAGE` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.