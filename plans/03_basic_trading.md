# –≠—Ç–∞–ø 3: –ë–∞–∑–æ–≤—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (Buy/Sell)

## üéØ –¶–µ–ª–∏

1.  –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å Jupiter API v6 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–º–µ–Ω–æ–≤.
2.  –°–æ–∑–¥–∞—Ç—å `SwapManager` –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –æ–±–º–µ–Ω–∞.
3.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã `/buy [tokenMint] [amountSOL]` –∏ `/sell [tokenMint] [amount]`.
4.  –í–Ω–µ–¥—Ä–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–æ–π.
5.  –û–±–µ—Å–ø–µ—á–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –æ—Ç–ø—Ä–∞–≤–∫—É —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ Solscan.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
DEX_BOT/
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ trading/
    ‚îÇ   ‚îî‚îÄ‚îÄ SwapManager.ts
    ‚îú‚îÄ‚îÄ utils/
    ‚îÇ   ‚îú‚îÄ‚îÄ ErrorHandler.ts
    ‚îÇ   ‚îî‚îÄ‚îÄ Solscan.ts
    ‚îî‚îÄ‚îÄ bot.ts
```

## üìù –ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1.  **`src/trading/SwapManager.ts`**:
    -   –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å `SwapManager`.
    -   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Jupiter API, –∏—Å–ø–æ–ª—å–∑—É—è `@jup-ag/api`.
    -   **`getQuote(inputMint, outputMint, amount)`**:
        -   –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ –æ—Ç Jupiter.
    -   **`getSwapTransaction(quote, userPublicKey)`**:
        -   –ú–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç Jupiter –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏.
    -   **`executeSwap(transaction, wallet)`**:
        -   –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ —Å–µ—Ç—å.
        -   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `connection.sendRawTransaction` –∏ `connection.confirmTransaction`.
        -   –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

2.  **`src/bot.ts`**:
    -   –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `SwapManager`.
    -   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `swapManager`.
    -   **`/buy [tokenMint] [amountSOL]`**:
        -   –†–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥—ã.
        -   –í—ã–∑–≤–∞—Ç—å `validateBalance` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ SOL.
        -   –í—ã–∑–≤–∞—Ç—å `swapManager` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ (SOL -> –¢–æ–∫–µ–Ω).
        -   –û—Ç–≤–µ—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ Solscan.
    -   **`/sell [tokenMint] [amount]`**:
        -   –†–∞—Å–ø–∞—Ä—Å–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã.
        -   –í—ã–∑–≤–∞—Ç—å `validateBalance` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤.
        -   –í—ã–∑–≤–∞—Ç—å `swapManager` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–¥–∞–∂–∏ (–¢–æ–∫–µ–Ω -> SOL).
        -   –û—Ç–≤–µ—Ç–∏—Ç—å —Å—Å—ã–ª–∫–æ–π –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.

3.  **`src/utils/ErrorHandler.ts`**:
    -   –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –æ–±—ä–µ–∫—Ç–∞ –æ—à–∏–±–∫–∏.

4.  **`src/utils/Solscan.ts`**:
    -   –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `getSolscanUrl(signature)` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

5.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)**:
    -   –î–æ–±–∞–≤–∏—Ç—å `JUPITER_API_KEY` –∏ `JUPITER_API_URL`, –µ—Å–ª–∏ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤–µ—Ä—Å–∏–∏ API.